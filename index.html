<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>George - Assistant de Serena</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; padding: 20px; display: flex; flex-direction: column; height: 95vh; margin: 0; }
        #chat { flex: 1; overflow-y: auto; background: white; padding: 15px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 10px; }
        .msg { margin: 10px 0; padding: 12px; border-radius: 10px; line-height: 1.4; max-width: 80%; }
        .bot { background: #eee; align-self: flex-start; }
        .user { background: #007bff; color: white; align-self: flex-end; text-align: right; margin-left: auto; }
        #area { display: flex; gap: 10px; }
        input { flex: 1; padding: 12px; border-radius: 5px; border: 1px solid #ddd; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="chat"><div class="msg bot"><strong>George :</strong> Bonjour Serena ! Je suis prêt. Pose-moi une question pour tester.</div></div>
    <div id="area">
        <input type="text" id="in" placeholder="Testez George ici...">
        <button onclick="send()">Envoyer</button>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        
        // TA CLÉ VÉRIFIÉE SUR TA CAPTURE D'ÉCRAN
        const API_KEY = "AIzaSyC-_A-nmJtcA4BFfkU9CDzCxMgSi6ek7Mc";
        const genAI = new GoogleGenerativeAI(API_KEY);

        window.send = async () => {
            const i = document.getElementById('in');
            const c = document.getElementById('chat');
            if (!i.value) return;
            
            const text = i.value;
            c.innerHTML += `<div class="msg user"><strong>Vous :</strong> ${text}</div>`;
            i.value = '';
            c.scrollTop = c.scrollHeight;

            // ON TESTE LES 3 NOMS DE MODÈLES POSSIBLES JUSQU'À CE QU'UN MARCHE
            const models = ["gemini-1.5-flash", "gemini-1.5-flash-latest", "gemini-pro"];
            let modelFound = false;

            for (let name of models) {
                if (modelFound) break;
                try {
                    const model = genAI.getGenerativeModel({ model: name });
                    const result = await model.generateContent("Réponds brièvement à : " + text);
                    const response = await result.response;
                    c.innerHTML += `<div class="msg bot"><strong>George :</strong> ${response.text()}</div>`;
                    modelFound = true;
                } catch (e) {
                    console.log("Nom " + name + " ne marche pas, j'essaie le suivant...");
                }
            }

            if (!modelFound) {
                c.innerHTML += `<div class="msg bot" style="color:red">George : Désolé, Google refuse encore la connexion. Vérifie tes 'Terms of Service' sur AI Studio.</div>`;
            }
            c.scrollTop = c.scrollHeight;
        };
    </script>
</body>
</html>
